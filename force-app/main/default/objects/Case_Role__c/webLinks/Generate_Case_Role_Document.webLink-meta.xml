<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Generate_Case_Role_Document</fullName>
    <availability>online</availability>
    <description>For WCA case role forms.</description>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Generate Case Role Document</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/24.0/connection.js&quot;)}; 
{!REQUIRESCRIPT(&quot;/soap/ajax/24.0/apex.js&quot;)}; 

var ids= {!GETRECORDIDS( $ObjectType.Case_Role__c )}; 
var idsReport=ids.join(&quot;|&quot;); 
var idsQuery=ids.join(&quot;&#39;|&#39;&quot;); 

if (ids.length == &#39;0&#39;) 
{ 
alert(&quot;Please select a Case Role&quot;); 
} 
else if(ids.length &gt; &#39;1&#39;) 
{ 
alert(&quot;Only one Case Role may be selected&quot;); 
} 
else 
{ 

var CongaURL = &quot;https://composer.congamerge.com&quot; + 
&quot;?sessionId={!$Api.Session_ID}&quot; + 
&quot;&amp;ServerUrl={!$Api.Partner_Server_URL_290}&quot; + 
&quot;&amp;Id={!DIR_Case__c.Id}&quot; + 
&quot;&amp;templategroup=WCARole&quot; + 
&quot;&amp;QueryId=[Govname]a0md0000003l2S0&quot; + 
//&quot;&amp;AC0=1&quot; + 
//&quot;&amp;DS3=0&quot; + 
&quot;&amp;DS6=1&quot; + 
//&quot;&amp;SC0=1&quot; + 
//&quot;&amp;SC1=Attachments&quot; + 
//&quot;&amp;OFN={template.label}&quot; + 

&quot;&amp;QueryId=[wcaoffice]a0md00000064cjOAAQ&quot; + 
&quot;&amp;QueryId=[Defendant]a0md00000064cjRAAQ&quot; +
&quot;&amp;QueryId=[Claimant]a0md00000064cj4&quot; +
&quot;&amp;reportid=[CaseRole]00Od0000004WoyG?pv0=&quot; + idsReport;

window.open( CongaURL, &quot;Conga&quot;, &quot;width=700,height=550,menubar=0&quot; ); 

}</url>
</WebLink>
